# 팝업에서 로그인 완료 후 콜백이 호출되지 않는 문제

`Auth.login() 호출 완료` 후 팝업이 열리고 로그인도 완료했는데 콜백(`success`)이 호출되지 않는 경우의 해결 방법입니다.

---

## 문제 원인

카카오 SDK v1.43.6의 `Auth.login()`은:
1. 팝업을 엽니다
2. 사용자가 팝업에서 로그인 완료
3. 카카오가 **설정된 Redirect URI로 리다이렉트**
4. **Redirect URI가 현재 페이지와 정확히 일치해야** `success` 콜백이 호출됨

만약 Redirect URI가 현재 페이지와 다르면, 팝업이 다른 페이지로 이동하면서 원래 페이지의 콜백이 호출되지 않습니다.

---

## 해결 방법

### 1. 카카오 개발자 콘솔에서 Redirect URI 설정 (가장 중요!)

1. [카카오 개발자 콘솔](https://developers.kakao.com/) 접속
2. **내 애플리케이션** → 앱 선택
3. **카카오 로그인** 탭 클릭
4. **Redirect URI 등록** 섹션에서 다음을 **정확히** 추가:
   ```
   http://localhost:3000/login
   ```
   ⚠️ **주의**: 
   - `http://localhost:3000` (X) - 끝에 `/login`이 없으면 안 됨
   - `http://localhost:3000/` (X) - 끝에 `/`가 있으면 안 됨
   - `https://localhost:3000/login` (X) - 프로토콜이 다르면 안 됨
   - `http://127.0.0.1:3000/login` (O) - 이것도 추가 가능

5. **저장** 클릭

---

### 2. 사이트 도메인도 확인

1. **앱 설정** → **플랫폼** 탭
2. **웹 플랫폼** 등록 확인
3. **사이트 도메인**에 다음 추가:
   ```
   http://localhost:3000
   http://127.0.0.1:3000
   ```

---

### 3. 설정 후 확인

1. 카카오 개발자 콘솔에서 Redirect URI **저장**
2. 서버 재시작 (`npm run dev` 중지 후 다시 시작)
3. 브라우저 **완전히 닫고 다시 열기** (또는 시크릿 모드)
4. `http://localhost:3000/login` 접속
5. 카카오 로그인 버튼 클릭
6. 팝업에서 로그인 완료
7. 콜백이 호출되는지 확인

---

## 팝업이 열리는지 확인

카카오 로그인 버튼 클릭 시:
1. **새 창/탭** 또는 **작은 팝업 창**이 열리는지 확인
2. 팝업이 열리면 → 카카오 로그인 완료
3. 팝업이 안 열리면 → **팝업 차단 해제** 필요

---

## 팝업에서 로그인 완료 후 확인

팝업에서 로그인을 완료하면:
1. 팝업이 **자동으로 닫히거나**
2. 팝업이 **다른 페이지로 리다이렉트**됩니다

팝업이 리다이렉트된 **URL을 확인**하세요:
- `http://localhost:3000/login?code=...` 또는
- `http://localhost:3000/login?access_token=...` 또는
- 다른 URL

만약 다른 URL로 리다이렉트되었다면, 그 URL을 Redirect URI에 추가하거나, 현재 페이지로 리다이렉트되도록 설정해야 합니다.

---

## 브라우저 콘솔에서 확인

팝업에서 로그인 완료 후, **원래 페이지의 콘솔**에서:
- `[카카오 로그인] ✅ 1단계 완료: 카카오 로그인 성공` 로그가 나와야 합니다
- 이 로그가 안 나오면 → Redirect URI 불일치

---

## 체크리스트

- [ ] 카카오 개발자 콘솔에서 Redirect URI에 `http://localhost:3000/login` 추가 (정확히 일치)
- [ ] Redirect URI 저장 완료
- [ ] 사이트 도메인에 `http://localhost:3000` 추가
- [ ] 서버 재시작
- [ ] 브라우저 완전히 닫고 다시 열기 (또는 시크릿 모드)
- [ ] 팝업이 열리는지 확인
- [ ] 팝업에서 로그인 완료
- [ ] 콘솔에서 `1단계 완료` 로그 확인

---

## 여전히 안 되면

1. 팝업에서 로그인 완료 후 **팝업의 URL** 확인
2. 그 URL이 `http://localhost:3000/login`으로 시작하는지 확인
3. 만약 다른 URL이면, 그 URL을 Redirect URI에 추가하거나, 현재 페이지로 리다이렉트되도록 설정

또는 브라우저 콘솔과 서버 터미널의 **전체 로그**를 알려주시면 더 정확히 도와드릴 수 있습니다.
