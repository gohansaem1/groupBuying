# 카카오 로그인 지연 문제 해결 가이드

카카오 로그인이 오래 걸리거나 멈추는 경우, 아래 순서로 확인하세요.

---

## 1. 브라우저 콘솔 확인 (가장 중요!)

**F12** 키를 눌러 개발자 도구를 열고, **Console** 탭을 확인하세요.

### 로그 단계별 의미:
- `[로그인 페이지] 카카오 로그인 시작` → 로그인 버튼 클릭됨
- `[카카오 로그인] 1단계: 카카오 로그인 팝업 열기 시작` → 팝업 열기 시도
- `[카카오 로그인] 1단계 완료: 카카오 로그인 성공` → 사용자가 카카오에서 동의 완료
- `[카카오 로그인] 2단계: 서버로 토큰 전송 시작` → 서버 API 호출 시작
- `[카카오 로그인] 3단계: Firebase 로그인 시작` → Firebase 인증 시작
- `[카카오 로그인] 4단계: 사용자 프로필 확인/생성` → 프로필 처리 중

**어느 단계에서 멈추는지 확인하면 원인을 찾을 수 있습니다.**

---

## 2. 흔한 원인과 해결 방법

### 원인 1: 카카오 로그인 팝업이 차단됨 (가장 흔함!)
**증상**: 1단계에서 멈춤, "팝업이 열리지 않았습니다" 에러, 콜백이 호출되지 않음

**해결**:
1. **브라우저 주소창 오른쪽**에서 **팝업 차단 아이콘** 클릭 → "항상 허용" 선택
2. 또는 브라우저 설정에서 `localhost` / `127.0.0.1` 팝업 허용
3. **시크릿 모드**에서 시도해보기 (확장 프로그램이 팝업을 차단할 수 있음)
4. **다른 브라우저**(Chrome, Edge 등)에서 시도해보기

---

### 원인 2: 카카오 SDK가 로드되지 않음
**증상**: "카카오 SDK가 준비되지 않았습니다" 에러

**해결**:
1. `.env.local` 파일에 `NEXT_PUBLIC_KAKAO_JS_KEY`가 올바르게 설정되어 있는지 확인
2. 값이 있으면 **서버 재시작** (`npm run dev` 중지 후 다시 시작)
3. 브라우저 **새로고침** (Ctrl + F5)

---

### 원인 3: 서버 API가 느리거나 실패
**증상**: 2단계에서 멈춤, "서버 응답이 지연되고 있습니다" 에러

**해결**:
1. **터미널 확인** - `npm run dev` 실행 중인 터미널에 에러가 있는지 확인
2. **환경 변수 확인** - `.env.local`에 Firebase Admin 설정이 올바른지 확인:
   - `FIREBASE_PROJECT_ID`
   - `FIREBASE_CLIENT_EMAIL`
   - `FIREBASE_PRIVATE_KEY`
3. **인터넷 연결** - 카카오 API(`kapi.kakao.com`)와 Firebase에 접근 가능한지 확인

---

### 원인 4: 카카오 앱 설정 문제
**증상**: 카카오 로그인 팝업은 열리지만 "동의" 후 에러

**해결**:
1. [카카오 개발자 콘솔](https://developers.kakao.com/) 접속
2. 내 애플리케이션 → 앱 선택 → 플랫폼 설정
3. **웹 플랫폼** 등록되어 있고, **사이트 도메인**에 `http://localhost:3000` 또는 `http://127.0.0.1:3000` 추가되어 있는지 확인
4. **카카오 로그인** 활성화되어 있는지 확인

---

### 원인 5: Firebase Admin 초기화 실패
**증상**: 서버 터미널에 "Firebase Admin 초기화 오류" 메시지

**해결**:
1. `.env.local`의 `FIREBASE_PRIVATE_KEY`가 **따옴표 안에** 있고, `\n`이 실제 줄바꿈으로 되어 있는지 확인
2. 예시:
   ```env
   FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...\n-----END PRIVATE KEY-----\n"
   ```
3. Firebase Console → 프로젝트 설정 → 서비스 계정에서 **새 비공개 키 만들기**로 다시 다운로드

---

## 3. 빠른 체크리스트

- [ ] 브라우저 콘솔(F12)에서 어느 단계에서 멈추는지 확인
- [ ] 팝업 차단 해제됨
- [ ] `.env.local`에 `NEXT_PUBLIC_KAKAO_JS_KEY` 설정됨
- [ ] `.env.local`에 Firebase Admin 설정(`FIREBASE_PROJECT_ID`, `FIREBASE_CLIENT_EMAIL`, `FIREBASE_PRIVATE_KEY`) 설정됨
- [ ] 카카오 개발자 콘솔에서 웹 플랫폼 등록 및 사이트 도메인 설정됨
- [ ] 서버(`npm run dev`) 재시작 후 브라우저 새로고침

---

## 4. 여전히 안 되면

1. **브라우저 콘솔(F12)의 에러 메시지** 전체를 복사
2. **서버 터미널의 에러 메시지** 확인
3. 위 정보와 함께 문의하시면 더 정확히 도와드릴 수 있습니다.
