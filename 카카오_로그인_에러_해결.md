# 카카오 로그인 "1단계 실패" 에러 해결 가이드

`[카카오 로그인] 1단계 실패: {}` 에러가 발생하는 경우, 아래를 확인하세요.

---

## 에러 의미

카카오 SDK의 `fail` 콜백이 호출되었지만 에러 객체가 비어있다는 것은:
- 사용자가 카카오 로그인 팝업에서 **취소**했거나
- 카카오 앱 설정 문제 (Redirect URI, 사이트 도메인 등) 또는
- 카카오 SDK 초기화/권한 문제일 수 있습니다.

---

## 해결 방법

### 1. 카카오 개발자 콘솔 설정 확인 (가장 중요!)

1. [카카오 개발자 콘솔](https://developers.kakao.com/) 접속
2. **내 애플리케이션** → 앱 선택
3. **앱 설정** → **플랫폼** 탭
4. **웹 플랫폼** 등록되어 있는지 확인
5. **사이트 도메인**에 다음이 추가되어 있는지 확인:
   - `http://localhost:3000`
   - `http://127.0.0.1:3000`
   - (프로덕션) 실제 도메인

6. **카카오 로그인** 탭 → **활성화 설정** → **활성화** 되어 있는지 확인
7. **Redirect URI** 설정:
   - `http://localhost:3000`
   - `http://127.0.0.1:3000`
   - (프로덕션) 실제 도메인

---

### 2. 환경 변수 확인

`.env.local` 파일에 다음이 올바르게 설정되어 있는지 확인:

```env
NEXT_PUBLIC_KAKAO_JS_KEY=여기에_JavaScript_키_붙여넣기
```

**JavaScript 키 가져오기:**
1. 카카오 개발자 콘솔 → 내 애플리케이션 → 앱 선택
2. **앱 설정** → **일반** 탭
3. **앱 키** 섹션에서 **JavaScript 키** 복사

**중요:** 환경 변수 변경 후에는 **서버를 재시작**해야 합니다!

---

### 3. 브라우저 콘솔 확인

**F12** → **Console** 탭에서 다음 로그 확인:

- `[카카오 로그인] SDK 버전:` - SDK가 로드되었는지 확인
- `[카카오 로그인] SDK 초기화 상태:` - `true`여야 함
- `[카카오 로그인] JS Key 설정 여부:` - `true`여야 함
- `[카카오 로그인] 현재 URL:` - 현재 접속 URL 확인

---

### 4. 팝업 동작 확인

카카오 로그인 버튼 클릭 시:
1. **팝업이 열리는지** 확인
2. 팝업이 열리면 **카카오 로그인을 완료**해야 함 (취소하면 에러 발생)
3. 팝업이 안 열리면 → **팝업 차단 해제** 필요

---

### 5. 시크릿 모드에서 시도

브라우저 확장 프로그램이 카카오 로그인을 방해할 수 있습니다:
- **시크릿 모드**(Ctrl + Shift + N)에서 시도
- 또는 확장 프로그램을 일시적으로 비활성화

---

### 6. 다른 브라우저에서 시도

브라우저별로 동작이 다를 수 있습니다:
- Chrome
- Edge
- Firefox

---

## 체크리스트

- [ ] 카카오 개발자 콘솔에서 **웹 플랫폼** 등록됨
- [ ] **사이트 도메인**에 `http://localhost:3000` 추가됨
- [ ] **Redirect URI**에 `http://localhost:3000` 추가됨
- [ ] **카카오 로그인** 활성화됨
- [ ] `.env.local`에 `NEXT_PUBLIC_KAKAO_JS_KEY` 설정됨
- [ ] 서버 재시작 (`npm run dev` 중지 후 다시 시작)
- [ ] 브라우저 새로고침 (Ctrl + F5)
- [ ] 팝업 차단 해제됨
- [ ] 카카오 로그인 팝업에서 **로그인 완료** (취소하지 않음)

---

## 여전히 안 되면

1. **브라우저 콘솔(F12)**의 **전체 로그**를 복사
2. **서버 터미널**의 에러 메시지 확인
3. 위 정보와 함께 문의하시면 더 정확히 도와드릴 수 있습니다.

---

## 참고: 카카오 SDK 로그인 방식

현재 코드는 **팝업 방식**을 사용합니다:
- `window.Kakao.Auth.login()` 호출 시 팝업이 열림
- 사용자가 팝업에서 로그인 완료하면 `success` 콜백 호출
- 사용자가 취소하거나 에러가 발생하면 `fail` 콜백 호출

**빈 에러 객체 `{}`**는 보통 사용자가 취소했거나 카카오 앱 설정 문제일 때 발생합니다.
